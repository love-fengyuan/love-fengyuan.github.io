<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Redis介绍与基本使用 | 永远在路上 生命不息 学习不止 | 请道上大佬，多多指教</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="redis">
    <meta name="description" content="1.Redis 介绍实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。Redis是什么？ ​      REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 ​      Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存">
<meta name="keywords" content="redis">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis介绍与基本使用">
<meta property="og:url" content="http://www.baidu.com/2019/05/06/redis/index.html">
<meta property="og:site_name" content="永远在路上 生命不息 学习不止">
<meta property="og:description" content="1.Redis 介绍实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。Redis是什么？ ​      REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 ​      Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://www.baidu.com/2019/05/06/redis/redis_dingyue.png">
<meta property="og:image" content="http://www.baidu.com/2019/05/06/redis/redis_fabu.png">
<meta property="og:image" content="http://www.baidu.com/2019/05/06/redis/redis_shiwu.png">
<meta property="og:image" content="http://www.baidu.com/2019/05/06/redis/javascript:void(0);">
<meta property="og:updated_time" content="2019-05-05T13:31:52.935Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redis介绍与基本使用">
<meta name="twitter:description" content="1.Redis 介绍实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。Redis是什么？ ​      REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 ​      Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存">
<meta name="twitter:image" content="http://www.baidu.com/2019/05/06/redis/redis_dingyue.png">
    
        <link rel="alternate" type="application/atom+xml" title="永远在路上 生命不息 学习不止" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpeg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">YuanFeng</h5>
          <a href="mailto:yfxxaq@163.com" title="yfxxaq@163.com" class="mail">yfxxaq@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                类别
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/love-fengyuan" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom">
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Redis介绍与基本使用</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Redis介绍与基本使用</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-05-05T21:05:14.000Z" itemprop="datePublished" class="page-time">
  2019-05-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/redis/">redis</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-Redis-介绍"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.Redis 介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。</span></a></li></ol></li></ol><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-Redis-优势"><span class="post-toc-number">2.</span> <span class="post-toc-text">2.Redis 优势</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-安装Redis"><span class="post-toc-number">3.</span> <span class="post-toc-text">3.安装Redis</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-配置文件"><span class="post-toc-number">4.</span> <span class="post-toc-text">4.配置文件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-Redis数据类型"><span class="post-toc-number">5.</span> <span class="post-toc-text">5.Redis数据类型</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#String（字符串）"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">String（字符串）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例"><span class="post-toc-number">5.1.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hash（哈希）"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">Hash（哈希）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-1"><span class="post-toc-number">5.2.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#List（列表）"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">List（列表）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-2"><span class="post-toc-number">5.3.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Set（集合）"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">Set（集合）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sadd-命令"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">sadd 命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-3"><span class="post-toc-number">5.5.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#zset-sorted-set：有序集合"><span class="post-toc-number">5.6.</span> <span class="post-toc-text">zset(sorted set：有序集合)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#zadd-命令"><span class="post-toc-number">5.7.</span> <span class="post-toc-text">zadd 命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-4"><span class="post-toc-number">5.7.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#6-Redis发布订阅与事务"><span class="post-toc-number">6.</span> <span class="post-toc-text">6.Redis发布订阅与事务</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#发布与订阅"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">发布与订阅</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-5"><span class="post-toc-number">6.1.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Redis-事务"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">Redis 事务</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#实例-6"><span class="post-toc-number">6.2.1.</span> <span class="post-toc-text">实例</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#7-Python操作Redis"><span class="post-toc-number">7.</span> <span class="post-toc-text">7.Python操作Redis</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#安装redis-py"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">安装redis-py</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#8-应用场景案例"><span class="post-toc-number">8.</span> <span class="post-toc-text">8.应用场景案例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）页面点击数"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">（1）页面点击数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）使用hash类型保存多样化对象，类似二维表结构"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">（2）使用hash类型保存多样化对象，类似二维表结构</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）社交圈子数据"><span class="post-toc-number">8.3.</span> <span class="post-toc-text">（3）社交圈子数据</span></a></li></ol></li>
        </nav>
    </aside>
    
<article id="post-redis" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Redis介绍与基本使用</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-05-05 21:05:14" datetime="2019-05-05T21:05:14.000Z" itemprop="datePublished">2019-05-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/redis/">redis</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="1-Redis-介绍"><a href="#1-Redis-介绍" class="headerlink" title="1.Redis 介绍"></a>1.Redis 介绍</h2><h4 id="实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。"><a href="#实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。" class="headerlink" title="实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。"></a>实现缓存的方式，有多种，本地内存缓存，数据库缓存，文件系统缓存。这里介绍使用Redis数据库进行缓存。</h4><p>Redis是什么？</p>
<p>​      REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。</p>
<p>​      Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<p>​      它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Map), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>
<p>Redis 简介</p>
<p>Redis 是完全开源免费的，遵守BSD协议，是一个高性能的key-value数据库。</p>
<p>Redis 与其他 key - value 缓存产品有以下三个特点：</p>
<ul>
<li>Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。</li>
<li>Redis不仅仅支持简单的key-value类型的数据(memcache)，同时还提供list，set，zset，hash等数据结构的存储。</li>
<li>Redis支持数据的备份，即master-slave模式的数据备份。</li>
</ul>
<h2 id="2-Redis-优势"><a href="#2-Redis-优势" class="headerlink" title="2.Redis 优势"></a>2.Redis 优势</h2><ul>
<li>性能极高 – Redis能读的速度是110000次/s,写的速度是81000次/s 。</li>
<li>丰富的数据类型 – Redis支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。</li>
<li>原子 – Redis的所有操作都是原子性的，意思就是要么成功执行要么失败完全不执行。单个操作是原子性的。多个操作也支持事务，即原子性，通过MULTI和EXEC指令包起来。</li>
<li>丰富的特性 – Redis还支持 publish/subscribe, 通知, key 过期等等特性。</li>
</ul>
<h2 id="3-安装Redis"><a href="#3-安装Redis" class="headerlink" title="3.安装Redis"></a>3.安装Redis</h2><p> wget <a href="http://download.redis.io/releases/redis-3.2.6.tar.gz" target="_blank" rel="noopener">http://download.redis.io/releases/redis-3.2.6.tar.gz</a></p>
<p>解压：</p>
<p>tar -zxvf redis-3.2.6.tar.gz</p>
<p>cd redis-3.2.6</p>
<p>编译：</p>
<p>cd redis-3.2.6  #进入目录<br>make   #编译</p>
<p>设置redis</p>
<p>mkdir /usr/local/redis #创建redis操作目录<br>cp src/redis-server src/redis-cli /usr/local/redis/bin/  #复制redis服务和命令<br>cp redis.conf /usr/local/redis/conf   #复制redis配置文件<br>cd /usr/local/redis<br>./bin/redis-server     conf/redis.conf    &amp;    #后台启动redis</p>
<p><strong>创建快捷键</strong></p>
<p>vim  ~/.bashrc<br>alias redis=’/usr/local/redis/bin/redis-cli’  #添加快捷键<br>source ~/.bashrc   #使生效</p>
<p>redis远程连接</p>
<p><strong>redis-cli  -h  172.16.245.xxx  -p 6379</strong> </p>
<p>redis 172.16.245.179:6379&gt; </p>
<p>安装验证成功！</p>
<h2 id="4-配置文件"><a href="#4-配置文件" class="headerlink" title="4.配置文件"></a>4.配置文件</h2><p>redis.conf 配置项说明如下：</p>
<ol>
<li>Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程</li>
</ol>
<p>​    <strong>daemonize no</strong></p>
<ol start="2">
<li>当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定</li>
</ol>
<p>​    <strong>pidfile /var/run/redis.pid</strong></p>
<ol start="3">
<li>指定Redis监听端口，默认端口为6379，作者在自己的一篇博文中解释了为什么选用6379作为默认端口，因为6379在手机按键上MERZ对应的号码，而MERZ取自意大利歌女Alessia Merz的名字</li>
</ol>
<p>​    <strong>port 6379</strong></p>
<ol start="4">
<li>绑定的主机地址</li>
</ol>
<p>​    <strong>bind 127.0.0.1</strong></p>
<ol start="5">
<li>当 客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能</li>
</ol>
<p>​    <strong>timeout 300</strong></p>
<ol start="6">
<li>指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose</li>
</ol>
<p>​    <strong>loglevel verbose</strong></p>
<ol start="7">
<li>日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null</li>
</ol>
<p>​    <strong>logfile stdout</strong></p>
<ol start="8">
<li>设置数据库的数量，默认数据库为0，可以使用SELECT <dbid>命令在连接上指定数据库id</dbid></li>
</ol>
<p>​    <strong>databases 16</strong></p>
<ol start="9">
<li>指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合</li>
</ol>
<p>​    <strong>save <seconds> <changes></changes></seconds></strong></p>
<p>​    Redis默认配置文件中提供了三个条件：</p>
<p>​    <strong>save 900 1</strong></p>
<p><strong>    save 300 10</strong></p>
<p><strong>    save 60 10000</strong></p>
<p>​    分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。</p>
<ol start="10">
<li>指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大</li>
</ol>
<p>​    <strong>rdbcompression yes</strong></p>
<ol start="11">
<li>指定本地数据库文件名，默认值为dump.rdb</li>
</ol>
<p>​    <strong>dbfilename dump.rdb</strong></p>
<ol start="12">
<li>指定本地数据库存放目录</li>
</ol>
<p>​    <strong>dir ./</strong></p>
<ol start="13">
<li>设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步</li>
</ol>
<p>​    <strong>slaveof <masterip> <masterport></masterport></masterip></strong></p>
<ol start="14">
<li>当master服务设置了密码保护时，slav服务连接master的密码</li>
</ol>
<p>​    <strong>masterauth <master-password></master-password></strong></p>
<ol start="15">
<li>设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH <password>命令提供密码，默认关闭</password></li>
</ol>
<p>​    <strong>requirepass foobared</strong></p>
<ol start="16">
<li>设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息</li>
</ol>
<p>​    <strong>maxclients 128</strong></p>
<ol start="17">
<li>指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区</li>
</ol>
<p>​    <strong>maxmemory <bytes></bytes></strong></p>
<ol start="18">
<li>指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no</li>
</ol>
<p>​    <strong>appendonly no</strong></p>
<ol start="19">
<li>指定更新日志文件名，默认为appendonly.aof</li>
</ol>
<p>​     <strong>appendfilename appendonly.aof</strong></p>
<ol start="20">
<li>指定更新日志条件，共有3个可选值：<br>​    <strong>no</strong>：表示等操作系统进行数据缓存同步到磁盘（快）<br>​    <strong>always</strong>：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全）<br>​    <strong>everysec</strong>：表示每秒同步一次（折衷，默认值）</li>
</ol>
<p>​    <strong>appendfsync everysec</strong></p>
<ol start="21">
<li>指定是否启用虚拟内存机制，默认值为no，简单的介绍一下，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析Redis的VM机制）</li>
</ol>
<p>​     <strong>vm-enabled no</strong></p>
<ol start="22">
<li>虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享</li>
</ol>
<p>​     <strong>vm-swap-file /tmp/redis.swap</strong></p>
<ol start="23">
<li>将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据 就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0</li>
</ol>
<p>​     <strong>vm-max-memory 0</strong></p>
<ol start="24">
<li>Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page大小最好设置为32或者64bytes；如果存储很大大对象，则可以使用更大的page，如果不 确定，就使用默认值</li>
</ol>
<p>​     <strong>vm-page-size 32</strong></p>
<ol start="25">
<li>设置swap文件中的page数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每8个pages将消耗1byte的内存。</li>
</ol>
<p>​     <strong>vm-pages 134217728</strong></p>
<ol start="26">
<li>设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4</li>
</ol>
<p>​     <strong>vm-max-threads 4</strong></p>
<ol start="27">
<li>设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启</li>
</ol>
<p>​    <strong>glueoutputbuf yes</strong></p>
<ol start="28">
<li>指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法</li>
</ol>
<p>​    <strong>hash-max-zipmap-entries 64</strong></p>
<p><strong>    hash-max-zipmap-value 512</strong></p>
<ol start="29">
<li>指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）</li>
</ol>
<p>​    <strong>activerehashing yes</strong></p>
<ol start="30">
<li>指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件</li>
</ol>
<p>​    <strong>include /path/to/local.conf</strong></p>
<p>查看配置信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG GET *</span><br></pre></td></tr></table></figure>
<h2 id="5-Redis数据类型"><a href="#5-Redis数据类型" class="headerlink" title="5.Redis数据类型"></a>5.Redis数据类型</h2><h3 id="String（字符串）"><a href="#String（字符串）" class="headerlink" title="String（字符串）"></a>String（字符串）</h3><p>​     string是redis最基本的类型，你可以理解成与Memcached一模一样的类型，一个key对应一个value。</p>
<p>string类型是二进制安全的。意思是redis的string可以包含任何数据。比如jpg图片或者序列化的对象 。</p>
<p>string类型是Redis最基本的数据类型，一个键最大能存储512MB。</p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SET name &quot;1000phone&quot;</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; GET name</span><br><span class="line">&quot;1000phone&quot;</span><br></pre></td></tr></table></figure>
<h3 id="Hash（哈希）"><a href="#Hash（哈希）" class="headerlink" title="Hash（哈希）"></a>Hash（哈希）</h3><p>Redis hash 是一个键值(key=&gt;value)对集合。</p>
<p>Redis hash是一个string类型的field和value的映射表，hash特别适合用于存储对象。</p>
<h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; HMSET myhash field1 &quot;Hello&quot; field2 &quot;World&quot;</span><br><span class="line">&quot;OK&quot;</span><br><span class="line">redis&gt; HGET myhash field1</span><br><span class="line">&quot;Hello&quot;</span><br><span class="line">redis&gt; HGET myhash field2</span><br><span class="line">&quot;World&quot;</span><br></pre></td></tr></table></figure>
<p>redis 172.16.245.179:6379&gt; hgetall myhash<br>1) “fd1”<br>2) “value1”<br>3) “fd2”<br>4) “value2”<br>5) “fd3”<br>6) “value2”</p>
<table>
<thead>
<tr>
<th>fd1</th>
<th>fd2</th>
<th>fd3</th>
</tr>
</thead>
<tbody>
<tr>
<td>value1</td>
<td>value2</td>
<td>value3</td>
</tr>
</tbody>
</table>
<h3 id="List（列表）"><a href="#List（列表）" class="headerlink" title="List（列表）"></a>List（列表）</h3><p>Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</p>
<h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; lpush name  redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush name mongodb</span><br><span class="line">(integer) 2</span><br><span class="line">redis 127.0.0.1:6379&gt; lpush name rabitmq</span><br><span class="line">(integer) 3</span><br><span class="line">redis 127.0.0.1:6379&gt; lrange name 0 10</span><br><span class="line">1) &quot;rabitmq&quot;</span><br><span class="line">2) &quot;mongodb&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br><span class="line">redis 127.0.0.1:6379&gt; rpop name</span><br></pre></td></tr></table></figure>
<h3 id="Set（集合）"><a href="#Set（集合）" class="headerlink" title="Set（集合）"></a>Set（集合）</h3><p>Redis的Set是string类型的无序集合。</p>
<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p>
<h3 id="sadd-命令"><a href="#sadd-命令" class="headerlink" title="sadd 命令"></a>sadd 命令</h3><p>添加一个 string 元素到 key 对应的 set 集合中，成功返回1，如果元素已经在集合中返回 0，如果 key 对应的 set 不存在则返回错误。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sadd key member</span><br></pre></td></tr></table></figure>
<h4 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; sadd name redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd name mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd name rabitmq</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; sadd name rabitmq</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; smembers name</span><br><span class="line"></span><br><span class="line">1) &quot;redis&quot;</span><br><span class="line">2) &quot;rabitmq&quot;</span><br><span class="line">3) &quot;mongodb&quot;</span><br></pre></td></tr></table></figure>
<h3 id="zset-sorted-set：有序集合"><a href="#zset-sorted-set：有序集合" class="headerlink" title="zset(sorted set：有序集合)"></a>zset(sorted set：有序集合)</h3><p>Redis zset 和 set 一样也是string类型元素的集合,且不允许重复的成员。</p>
<p>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>
<p>zset的成员是唯一的,但分数(score)却可以重复。</p>
<h3 id="zadd-命令"><a href="#zadd-命令" class="headerlink" title="zadd 命令"></a>zadd 命令</h3><p>添加元素到集合，元素在集合中存在则更新对应score</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zadd key score member</span><br></pre></td></tr></table></figure>
<h4 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 redis</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 mongodb</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 rabitmq</span><br><span class="line">(integer) 1</span><br><span class="line">redis 127.0.0.1:6379&gt; zadd runoob 0 rabitmq</span><br><span class="line">(integer) 0</span><br><span class="line">redis 127.0.0.1:6379&gt; &gt; ZRANGEBYSCORE runoob 0 1000</span><br><span class="line">1) &quot;mongodb&quot;</span><br><span class="line">2) &quot;rabitmq&quot;</span><br><span class="line">3) &quot;redis&quot;</span><br></pre></td></tr></table></figure>
<h2 id="6-Redis发布订阅与事务"><a href="#6-Redis发布订阅与事务" class="headerlink" title="6.Redis发布订阅与事务"></a>6.Redis发布订阅与事务</h2><h3 id="发布与订阅"><a href="#发布与订阅" class="headerlink" title="发布与订阅"></a>发布与订阅</h3><p>​Redis 发布订阅(pub/sub)是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。</p>
<p>Redis 客户端可以订阅任意数量的频道。</p>
<p>​下图展示了频道 channel1 ， 以及订阅这个频道的三个客户端 —— client2 、 client5 和 client1 之间的关系：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2019/05/06/redis/redis_dingyue.png" alt="redis订阅" title>
                </div>
                <div class="image-caption">redis订阅</div>
            </figure>
<p>当有新消息通过 PUBLISH 命令发送给频道 channel1 时， 这个消息就会被发送给订阅它的三个客户端：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2019/05/06/redis/redis_fabu.png" alt="redis发布" title>
                </div>
                <div class="image-caption">redis发布</div>
            </figure>
<hr>
<h4 id="实例-5"><a href="#实例-5" class="headerlink" title="实例"></a>实例</h4><p>以下实例演示了发布订阅是如何工作的。在我们实例中我们创建了订阅频道名为 <strong>redisChat</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; SUBSCRIBE redisChat</span><br><span class="line"></span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) &quot;subscribe&quot;</span><br><span class="line">2) &quot;redisChat&quot;</span><br><span class="line">3) (integer) 1</span><br></pre></td></tr></table></figure>
<p>现在，我们先重新开启个 redis 客户端，然后在同一个频道 redisChat 发布两次消息，订阅者就能接收到消息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Redis is a great caching technique&quot;</span><br><span class="line"></span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:6379&gt; PUBLISH redisChat &quot;Learn redis by runoob.com&quot;</span><br><span class="line"></span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line"># 订阅者的客户端会显示如下消息</span><br><span class="line">1) &quot;message&quot;</span><br><span class="line">2) &quot;redisChat&quot;</span><br><span class="line">3) &quot;Redis is a great caching technique&quot;</span><br><span class="line">1) &quot;message&quot;</span><br><span class="line">2) &quot;redisChat&quot;</span><br><span class="line">3) &quot;Learn redis by runoob.com&quot;</span><br></pre></td></tr></table></figure>
<h3 id="Redis-事务"><a href="#Redis-事务" class="headerlink" title="Redis 事务"></a>Redis 事务</h3><p>Redis 事务可以一次执行多个命令， 并且带有以下两个重要的保证：</p>
<p>批量操作在发送 EXEC 命令前被放入队列缓存。<br>收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行。<br>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</p>
<p>一个事务从开始到执行会经历以下三个阶段：</p>
<p>开始事务。<br>命令入队。<br>执行事务。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2019/05/06/redis/redis_shiwu.png" alt="redis事务" title>
                </div>
                <div class="image-caption">redis事务</div>
            </figure>
<h4 id="实例-6"><a href="#实例-6" class="headerlink" title="实例"></a>实例</h4><p>以下是一个事务的例子， 它先以 MULTI开始一个事务， 然后将多个命令入队到事务中， 最后由 EXEC 命令触发事务， 一并执行事务中的所有命令：</p>
<p>redis 127.0.0.1:6379&gt; MULTI</p>
<p>OK</p>
<p>redis 127.0.0.1:6379&gt; SET book-name “Mastering C++ in 21 days”</p>
<p>QUEUED</p>
<p>redis 127.0.0.1:6379&gt; GET book-name</p>
<p>QUEUED</p>
<p>redis 127.0.0.1:6379&gt; SADD tag “C++” “Programming” “Mastering Series”</p>
<p>QUEUED</p>
<p>redis 127.0.0.1:6379&gt; SMEMBERS tag</p>
<p>QUEUED</p>
<p>redis 127.0.0.1:6379&gt; EXEC</p>
<p>1) OK</p>
<p>2) “Mastering C++ in 21 days”</p>
<p>3) (integer) 3</p>
<p>4) 1) “Mastering Series”</p>
<p>2) “C++”</p>
<p>3) “Programming”</p>
<p>单个 Redis 命令的执行是原子性的，但 Redis 没有在事务上增加任何维持原子性的机制，所以 Redis 事务的执行并不是原子性的。</p>
<p>事务可以理解为一个打包的批量执行脚本，但批量指令并非原子化的操作，中间某条指令的失败不会导致前面已做指令的回滚，也不会造成后续的指令不做。</p>
<p>比如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:7000&gt; multi</span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:7000&gt; set a aaa</span><br><span class="line"></span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:7000&gt; set b bbb</span><br><span class="line"></span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:7000&gt; set c ccc</span><br><span class="line"></span><br><span class="line">QUEUED</span><br><span class="line"></span><br><span class="line">redis 127.0.0.1:7000&gt; exec</span><br><span class="line"></span><br><span class="line">1) OK</span><br><span class="line"></span><br><span class="line">2) OK</span><br><span class="line"></span><br><span class="line">3) OK</span><br></pre></td></tr></table></figure></p>
<p>如果在 set b bbb 处失败，set a 已成功不会回滚，set c 还会继续执行。</p>
<h2 id="7-Python操作Redis"><a href="#7-Python操作Redis" class="headerlink" title="7.Python操作Redis"></a>7.Python操作Redis</h2><h3 id="安装redis-py"><a href="#安装redis-py" class="headerlink" title="安装redis-py"></a><strong>安装redis-py</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure>
<p>redis-py 的API的使用可以分类为：</p>
<ul>
<li><p>连接方式</p>
</li>
<li><p>连接池</p>
</li>
<li><p>操作</p>
<ul>
<li>String 操作</li>
<li>Hash 操作</li>
<li>List 操作</li>
<li>Set 操作</li>
<li>Sort Set 操作</li>
</ul>
</li>
<li><p>管道</p>
<p>redis-py提供两个类Redis和StrictRedis用于实现Redis的命令，StrictRedis用于实现大部分官方的命令，并使用官方的语法和命令，Redis是StrictRedis的子类</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import redis</span><br><span class="line"></span><br><span class="line">r = redis.Redis(host=&apos;192.168.49.130&apos;, port=6379)</span><br><span class="line">r.set(&apos;foo&apos;, &apos;Bar&apos;)</span><br><span class="line">print r.get(&apos;foo&apos;)</span><br></pre></td></tr></table></figure>
<p><strong>创建连接池</strong>:</p>
<p>　　redis-py使用connection pool来管理对一个redis server的所有连接，避免每次建立、释放连接的开销。默认，每个Redis实例都会维护一个自己的连接池。可以直接建立一个连接池，然后作为参数Redis，这样就可以实现多个Redis实例共享一个连接池。</p>
<p>[<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2019/05/06/redis/javascript:void(0);" alt="复制代码](https://common.cnblogs.com/images/copycode.gif)" title>
                </div>
                <div class="image-caption">复制代码](https://common.cnblogs.com/images/copycode.gif)</div>
            </figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import redis</span><br><span class="line"> </span><br><span class="line">pool = redis.ConnectionPool(host=&apos;192.168.49.130&apos;, port=6379)</span><br><span class="line"> </span><br><span class="line">r = redis.Redis(connection_pool=pool)</span><br><span class="line">#r = redis.StrictRedis(connection_pool=pool) #StrictRedis也是支持的</span><br><span class="line">r.set(&apos;foo&apos;, &apos;Bar&apos;)</span><br><span class="line">print r.get(&apos;foo&apos;)</span><br></pre></td></tr></table></figure>
<p>MySQL数据有两种存储引擎：</p>
<p>MyISAM   — 表锁</p>
<p>INONDB   — 表行锁   ———这种存储方式推荐使用， 支持事务</p>
<h2 id="8-应用场景案例"><a href="#8-应用场景案例" class="headerlink" title="8.应用场景案例"></a>8.应用场景案例</h2><h3 id="（1）页面点击数"><a href="#（1）页面点击数" class="headerlink" title="（1）页面点击数"></a>（1）页面点击数</h3><p>​     假定我们对一系列页面需要记录点击次数。例如论坛的每个帖子都要记录点击次数，而点击次数比回帖的次数的多得多。如果使用关系数据库来存储点击，可能存在大量的行级锁争用。所以，点击数的增加使用redis的INCR命令最好不过了。</p>
<p>​     当redis服务器启动时，可以从关系数据库读入点击数的初始值（1237这个页面被访问了34634次）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.set(&quot;visit:1237:totals&quot;,34634)</span><br><span class="line"></span><br><span class="line">True</span><br></pre></td></tr></table></figure>
<p>每当有一个页面点击，则使用INCR增加点击数即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.incr(&quot;visit:1237:totals&quot;)</span><br><span class="line"></span><br><span class="line">34635</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.incr(&quot;visit:1237:totals&quot;)</span><br><span class="line"></span><br><span class="line">34636</span><br><span class="line"></span><br><span class="line">页面载入的时候则可直接获取这个值</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.get (&quot;visit:1237:totals&quot;)</span><br><span class="line"></span><br><span class="line">&apos;34636&apos;</span><br></pre></td></tr></table></figure>
<h3 id="（2）使用hash类型保存多样化对象，类似二维表结构"><a href="#（2）使用hash类型保存多样化对象，类似二维表结构" class="headerlink" title="（2）使用hash类型保存多样化对象，类似二维表结构"></a>（2）使用hash类型保存多样化对象，类似二维表结构</h3><p>当有大量类型文档的对象，文档的内容都不一样时，（即“表”没有固定的列），可以使用hash来表达。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.hset(&apos;users:jdoe&apos;,  &apos;name&apos;, &quot;John Doe&quot;)</span><br><span class="line"></span><br><span class="line">1L</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.hset(&apos;users:jdoe&apos;, &apos;email&apos;, &apos;John@test.com&apos;)</span><br><span class="line"></span><br><span class="line">1L</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.hset(&apos;users:jdoe&apos;,  &apos;phone&apos;, &apos;1555313940&apos;)</span><br><span class="line"></span><br><span class="line">1L</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.hincrby(&apos;users:jdoe&apos;, &apos;visits&apos;, 1)</span><br><span class="line"></span><br><span class="line">1L</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.hgetall(&apos;users:jdoe&apos;)</span><br><span class="line"></span><br><span class="line">&#123;&apos;phone&apos;: &apos;1555313940&apos;, &apos;name&apos;: &apos;John Doe&apos;, &apos;visits&apos;: &apos;1&apos;, &apos;email&apos;: &apos;John@test.com&apos;&#125;</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r.hkeys(&apos;users:jdoe&apos;)</span><br><span class="line"></span><br><span class="line">[&apos;name&apos;, &apos;email&apos;, &apos;phone&apos;, &apos;visits&apos;]</span><br></pre></td></tr></table></figure>
<h3 id="（3）社交圈子数据"><a href="#（3）社交圈子数据" class="headerlink" title="（3）社交圈子数据"></a>（3）社交圈子数据</h3><p>​在社交网站中，每一个圈子(circle)都有自己的用户群。通过圈子可以找到有共同特征（比如某一体育活动、游戏、电影等爱好者）的人。当一个用户加入一个或几个圈子后，系统可以向这个用户推荐圈子中的人。<br>​我们定义这样两个圈子,并加入一些圈子成员。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:game:lol&apos;,&apos;user:debugo&apos;)</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:game:lol&apos;,&apos;user:leo&apos;)</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:game:lol&apos;,&apos;user:Guo&apos;)</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:soccer:InterMilan&apos;,&apos;user:Guo&apos;)</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:soccer:InterMilan&apos;,&apos;user:Levis&apos;)</span><br><span class="line">1</span><br><span class="line">&gt;&gt;&gt; r.sadd(&apos;circle:soccer:InterMilan&apos;,&apos;user:leo&apos;)</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>获取一个圈子的成员</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.smembers(&apos;circle:game:lol&apos;)</span><br><span class="line">set([&apos;user:Guo&apos;, &apos;user:debugo&apos;, &apos;user:leo&apos;])</span><br></pre></td></tr></table></figure>
<p>可以使用集合运算来得到几个圈子的共同成员：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r.sinter(&apos;circle:game:lol&apos;, &apos;circle:soccer:InterMilan&apos;)</span><br><span class="line">set([&apos;user:Guo&apos;, &apos;user:leo&apos;])</span><br><span class="line">&gt;&gt;&gt; r.sunion(&apos;circle:game:lol&apos;, &apos;circle:soccer:InterMilan&apos;)</span><br><span class="line">set([&apos;user:Levis&apos;, &apos;user:Guo&apos;, &apos;user:debugo&apos;, &apos;user:leo&apos;])</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-05-05T13:31:52.935Z" itemprop="dateUpdated">2019-05-05 13:31:52</time>
</span><br>


        
        生命不息，学习不止
        
    </div>
    <footer>
        <a href="http://www.baidu.com">
            <img src="/img/avatar.jpeg" alt="YuanFeng">
            YuanFeng
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.baidu.com/2019/05/06/redis/&title=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&pic=http://www.baidu.com/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.baidu.com/2019/05/06/redis/&title=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.baidu.com/2019/05/06/redis/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&url=http://www.baidu.com/2019/05/06/redis/&via=http://www.baidu.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.baidu.com/2019/05/06/redis/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/05/06/git_server/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">git服务器搭建</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/05/06/django/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">django</h4>
      </a>
    </div>
  
</nav>



    
















</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>YuanFeng &copy; 2019</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.baidu.com/2019/05/06/redis/&title=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&pic=http://www.baidu.com/img/avatar.jpeg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.baidu.com/2019/05/06/redis/&title=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.baidu.com/2019/05/06/redis/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Redis介绍与基本使用》 — 永远在路上 生命不息 学习不止&url=http://www.baidu.com/2019/05/06/redis/&via=http://www.baidu.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.baidu.com/2019/05/06/redis/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABy0lEQVR42u3awY7DIAxF0f7/T2e2I1Uh9xnsyUiXVZS29LB5wobPB4/r1yCffj+v3xwecuXK3eZey8FB389r+vr97ZLkypU7yL1LjPV31sHE3xODXLly38/lkUTmlCtX7n/n1jZDfMMkV67c93AJgkRV2i5prNXkypW7weVdyr7nlv6uXLlyS9wrHLVQI80R9O9y5cod4fJAqR1+pAtA35QrV24zl5cuvG2RtkqD/5UrV+44tzYFDyN+JPOwI5MrV24zl29ESPFz6jj2YU65cuU2c2sNjhSadj5R8SNXrtw2Lt9k7FzIOHVsI1eu3HluWgLxS1qkScq3O3Llyp3k1kqU2jL4r25rNbly5TZz+VajxqrdsEqPY+XKldvB3WlhkCNVsnni7+XKldvN5e3ROAvDeYKGqVy5cke4pEQhhyW1mAtmkCtX7iD3IT5wMK1n4KVR8LFcuXKPcq9wpO3RWit2q5siV67cbW56JSJtf/DtEWnKyJUrd5KbtkR5tJGlxpshuXLlDnJ5kcMXGddhPMjkypX7Mm4t7NKjlGNBJleu3EFurTSqhdqBIJMrV26JW7s6yaOqVjLJlSv3r7hxlGxMXSuW5MqVO8j9AemlSOePgu5FAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };



</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '小可爱，快回来吧！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
